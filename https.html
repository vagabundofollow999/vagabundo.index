<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Vagabundo TV</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/shaka-player@4.14.10/dist/shaka-player.compiled.js"></script>

<style>
body {
  background: #000;
  margin: 0;
  font-family: Arial, sans-serif;
  color: #fff;
}

/* --- LAYOUT PC --- */
#container {
  display: flex;
  height: 100vh;
}

#channels {
  width: 280px;
  background: #111;
  overflow-y: auto;
  padding: 10px;
  border-right: 2px solid #222;
}

#player {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #000;
}

video {
  width: 100%;
  height: 100%;
  background: #000;
}

/* --- LAYOUT CELULAR --- */
@media (max-width: 768px) {

  #container {
    flex-direction: column;
    height: auto;
  }

  #channels {
    width: 100%;
    height: auto;
    border-right: none;
    border-bottom: 2px solid #222;
  }

  #player {
    width: 100%;
    height: calc(100vh - 200px);
  }

  video {
    width: 100%;
    height: 100%;
  }
}
.channel {
  display: flex;
  align-items: center;
  padding: 10px;
  margin-bottom: 8px;
  background: #1a1a1a;
  border-radius: 8px;
  cursor: pointer;
}
.channel img {
  width: 60px;
  height: 45px;
  object-fit: contain;
  margin-right: 10px;
}
</style>
</head>
<body>

<div id="container">
  <div id="channels"><h2>Vagabundo ðŸ‡µðŸ‡¾</h2></div>

  <div id="player">
    <video id="video" controls playsinline muted></video>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  shaka.polyfill.installAll();
});

// Canales
const channels = [
  {
    name: "Tigo Sports 1",
    url: "https://d3kzwqwnq1f7tq.cloudfront.net/out/v1/25ca218d53194065bedf6d998ace462e/index.mpd",
    type: "mpd",
    clearKeys: { "1c62a216a5fe423f959cb1ca02f62d83": "54f2fdc83c1da33cd9269bf21e08218c" },
    icono: "https://i.ibb.co/Cs77Ttc7/tig-rezise.png"
  },
  {
    name: "Tigo Sports 2",
    url: "https://d2jluxxgx550su.cloudfront.net/out/v1/62de20495af84f908fa8963f50c44d46/index.mpd",
    type: "mpd",
    clearKeys: { "49b2c0e7037042b2aff9f064e0bb3311": "83849e30adf85440550292693147fbf7" },
    icono: "https://i.ibb.co/Cs77Ttc7/tig-rezise.png"
  },
  {
    name: "ESPN",
    url: "http://45.184.109.10/live/69393EAE6ADBC65A68F942022362A202/89.m3u8",
    type: "hls",
    icono: "https://assetshuluimcom-a.akamaihd.net/h3o/landing/networks/wall/espn-network-logo.png"
  }
];

const channelsDiv = document.getElementById("channels");
const video = document.getElementById("video");
let hls = null;
let shakaPlayer = null;

// Render lista
channels.forEach((ch, i) => {
  const div = document.createElement("div");
  div.className = "channel";
  div.onclick = () => playChannel(i);
  div.innerHTML = `<img src="${ch.icono}"><div>${ch.name}</div>`;
  channelsDiv.appendChild(div);
});

async function playChannel(index) {
  const ch = channels[index];

  // Limpieza
  if (hls) { hls.destroy(); hls = null; }
  if (shakaPlayer) { shakaPlayer.destroy(); shakaPlayer = null; }

  video.src = "";

  if (ch.type === "hls") {
    if (Hls.isSupported()) {
      hls = new Hls();
      hls.loadSource(ch.url);
      hls.attachMedia(video);
    } else {
      video.src = ch.url;
    }
  }

  if (ch.type === "mpd") {
    shakaPlayer = new shaka.Player(video);
    shakaPlayer.configure({ drm: { clearKeys: ch.clearKeys } });
    await shakaPlayer.load(ch.url);
  }

  // Autoplay fix en Android
  video.play().catch(() => {
    video.addEventListener("touchstart", () => video.play(), { once: true });
  });
}

// Reproducir primer canal
playChannel(0);
</script>
</body>
</html>


